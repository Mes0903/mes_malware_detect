#ifndef WEAK_LEARNER__
#define WEAK_LEARNER__

/**
 * @file logistic.h
 * @author Mes (mes900903@gmail.com) (Discord: Mes#0903)
 * @brief The weak learner in Adaboost.
 * @version 0.1
 * @date 2022-11-17
 */

#include "Eigen/Eigen"

#include <vector>
#include <fstream>
#include <tuple>

/**
 * @brief The weak learner in Adaboost.
 */
class logistic {
public:
  Eigen::MatrixXd w;
  Eigen::RowVectorXd w0;

public:
  std::tuple<Eigen::VectorXd, double, bool> fit(const Eigen::MatrixXd &train_X, const Eigen::MatrixXd &train_Y, const Eigen::VectorXd &train_weight = Eigen::VectorXd::Ones(300), uint32_t Iterations = 500);    // training

  Eigen::ArrayXXd cal_softmax(const Eigen::ArrayXXd &x) const;    // logistic function
  Eigen::VectorXd predict(const Eigen::MatrixXd &section) const;    // predict the section data

public:
  void store_weight(std::ofstream &outfile) const;    // store the weight vector
  void load_weight(std::ifstream &infile);    // load the weight vector
};

#endif